<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang=en lang=en> <head> <meta http-equiv=Content-Type content="text/html; charset=utf-8"/> <title> Class: Sass::Tree::Visitors::CheckNesting &mdash; Sass Documentation </title> <link rel=stylesheet href="../../../css/style-03d6d7d0.css" charset=utf-8 /> <link rel=stylesheet href="../../../../assets/css/docs-eb9372d5.css" charset=utf-8 /> <script charset=utf-8>
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!Sass/Tree/Visitors/CheckNesting.html";
</script> <script charset=utf-8 src="../../../js/jquery-89b1e99e.js"></script> <script charset=utf-8 src="../../../js/app-760e64ba.js"></script> </head> <body> <div id=header> <div id=menu> <a href="../../../_index.html">Index (C)</a> &raquo; <span class=title><span class=object_link><a href="../../../Sass.html" title="Sass (module)">Sass</a></span></span> &raquo; <span class=title><span class=object_link><a href="../../Tree.html" title="Sass::Tree (module)">Tree</a></span></span> &raquo; <span class=title><span class=object_link><a href="../Visitors.html" title="Sass::Tree::Visitors (module)">Visitors</a></span></span> &raquo; <span class=title>CheckNesting</span> <div class=noframes><span class=title>(</span><a href="." target=_top>no frames</a><span class=title>)</span></div> </div> <div id=search> <a class=full_list_link id=class_list_link href="../../../class_list.html"> Class List </a> <a class=full_list_link id=method_list_link href="../../../method_list.html"> Method List </a> <a class=full_list_link id=file_list_link href="../../../file_list.html"> File List </a> </div> <div class=clear></div> </div> <iframe id=search_frame></iframe> <div id=content><h1>Class: Sass::Tree::Visitors::CheckNesting </h1> <dl class=box> <dt class=r1>Inherits:</dt> <dd class=r1> <span class=inheritName><span class=object_link><a href="Base.html" title="Sass::Tree::Visitors::Base (class)">Base</a></span></span> <ul class=fullTree> <li>Object</li> <li class=next><span class=object_link><a href="Base.html" title="Sass::Tree::Visitors::Base (class)">Base</a></span></li> <li class=next>Sass::Tree::Visitors::CheckNesting</li> </ul> <a href="#" class=inheritanceTree>show all</a> </dd> <dt class="r2 last">Defined in:</dt> <dd class="r2 last">/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb</dd> </dl> <div class=clear></div> <h2>Overview</h2><div class=docstring> <div class=discussion> <p>A visitor for checking that all nodes are properly nested.</p> </div> </div> <div class=tags> </div> <h2>Constant Summary</h2> <h2> Instance Method Summary <small>(<a href="#" class=summary_toggle>collapse</a>)</small> </h2> <ul class=summary> <li class="protected "> <span class=summary_signature> <a href="#initialize-instance_method" title="#initialize (instance method)">- (CheckNesting) <strong>initialize</strong> </a> </span> <span class="note title constructor">constructor</span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline> <p>A new instance of CheckNesting.</p> </div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_charset_parent%3F-instance_method" title="#invalid_charset_parent? (instance method)">- (Boolean) <strong>invalid_charset_parent?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_content_parent%3F-instance_method" title="#invalid_content_parent? (instance method)">- (Boolean) <strong>invalid_content_parent?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_extend_parent%3F-instance_method" title="#invalid_extend_parent? (instance method)">- (Boolean) <strong>invalid_extend_parent?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_function_child%3F-instance_method" title="#invalid_function_child? (instance method)">- (Boolean) <strong>invalid_function_child?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_function_parent%3F-instance_method" title="#invalid_function_parent? (instance method)">- (Boolean) <strong>invalid_function_parent?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_import_parent%3F-instance_method" title="#invalid_import_parent? (instance method)">- (Boolean) <strong>invalid_import_parent?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_mixindef_parent%3F-instance_method" title="#invalid_mixindef_parent? (instance method)">- (Boolean) <strong>invalid_mixindef_parent?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_prop_child%3F-instance_method" title="#invalid_prop_child? (instance method)">- (Boolean) <strong>invalid_prop_child?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_prop_parent%3F-instance_method" title="#invalid_prop_parent? (instance method)">- (Boolean) <strong>invalid_prop_parent?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#invalid_return_parent%3F-instance_method" title="#invalid_return_parent? (instance method)">- (Boolean) <strong>invalid_return_parent?</strong>(parent, child) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#visit-instance_method" title="#visit (instance method)">- <strong>visit</strong>(node) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#visit_children-instance_method" title="#visit_children (instance method)">- <strong>visit_children</strong>(parent) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#visit_import-instance_method" title="#visit_import (instance method)">- <strong>visit_import</strong>(node) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#visit_mixindef-instance_method" title="#visit_mixindef (instance method)">- <strong>visit_mixindef</strong>(node) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> <li class="protected "> <span class=summary_signature> <a href="#visit_root-instance_method" title="#visit_root (instance method)">- <strong>visit_root</strong>(node) </a> </span> <span class="note title protected">protected</span> <span class=summary_desc><div class=inline></div></span> </li> </ul> <h3 class=inherited>Methods inherited from <span class=object_link><a href="Base.html" title="Sass::Tree::Visitors::Base (class)">Base</a></span></h3> <p class=inherited><span class=object_link><a href="Base.html#node_name-class_method" title="Sass::Tree::Visitors::Base.node_name (method)">node_name</a></span>, <span class=object_link><a href="Base.html#visit-class_method" title="Sass::Tree::Visitors::Base.visit (method)">visit</a></span>, <span class=object_link><a href="Base.html#visit_if-instance_method" title="Sass::Tree::Visitors::Base#visit_if (method)">#visit_if</a></span></p> <div id=constructor_details class=method_details_list> <h2>Constructor Details</h2> <div class="method_details first"> <h3 class="signature first" id=initialize-instance_method> - (<tt><span class=object_link><a href="" title="Sass::Tree::Visitors::CheckNesting (class)">CheckNesting</a></span></tt>) <strong>initialize</strong> <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> <p>Returns a new instance of CheckNesting</p> </div> </div> <div class=tags> </div><table class=source_code> <tr> <td> <pre class=lines>


5
6
7</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 5</span>

def initialize
  @parents = []
end</pre> </td> </tr> </table> </div> </div> <div id=instance_method_details class=method_details_list> <h2>Instance Method Details</h2> <div class="method_details first"> <h3 class="signature first" id="invalid_charset_parent?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_charset_parent?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


87
88
89</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 87</span>

def invalid_charset_parent?(parent, child)
  &quot;@charset may only be used at the root of a document.&quot; unless parent.is_a?(Sass::Tree::RootNode)
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_content_parent?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_content_parent?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


78
79
80
81
82
83
84
85</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 78</span>

def invalid_content_parent?(parent, child)
  if @current_mixin_def
    @current_mixin_def.has_content = true
    nil
  else
    &quot;@content may only be used within a mixin.&quot;
  end
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_extend_parent?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_extend_parent?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


92
93
94
95
96</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 92</span>

def invalid_extend_parent?(parent, child)
  unless is_any_of?(parent, VALID_EXTEND_PARENTS)
    return &quot;Extend directives may only be used within rules.&quot;
  end
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_function_child?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_function_child?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


128
129
130
131
132</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 128</span>

def invalid_function_child?(parent, child)
  unless is_any_of?(child, VALID_FUNCTION_CHILDREN)
    &quot;Functions can only contain variable declarations and control directives.&quot;
  end
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_function_parent?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_function_parent?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


118
119
120
121
122</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 118</span>

def invalid_function_parent?(parent, child)
  unless (@parents.map {|p| p.class} &amp; INVALID_IMPORT_PARENTS).empty?
    return &quot;Functions may not be defined within control directives or other mixins.&quot;
  end
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_import_parent?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_import_parent?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


100
101
102
103
104
105
106
107
108
109
110</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 100</span>

def invalid_import_parent?(parent, child)
  unless (@parents.map {|p| p.class} &amp; INVALID_IMPORT_PARENTS).empty?
    return &quot;Import directives may not be used within control directives or mixins.&quot;
  end
  return if parent.is_a?(Sass::Tree::RootNode)
  return &quot;CSS import directives may only be used at the root of a document.&quot; if child.css_import?
rescue Sass::SyntaxError =&gt; e
  e.modify_backtrace(:filename =&gt; child.imported_file.options[:filename])
  e.add_backtrace(:filename =&gt; child.filename, :line =&gt; child.line)
  raise e
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_mixindef_parent?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_mixindef_parent?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


112
113
114
115
116</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 112</span>

def invalid_mixindef_parent?(parent, child)
  unless (@parents.map {|p| p.class} &amp; INVALID_IMPORT_PARENTS).empty?
    return &quot;Mixins may not be defined within control directives or other mixins.&quot;
  end
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_prop_child?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_prop_child?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


137
138
139
140
141</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 137</span>

def invalid_prop_child?(parent, child)
  unless is_any_of?(child, VALID_PROP_CHILDREN)
    &quot;Illegal nesting: Only properties may be nested beneath properties.&quot;
  end
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_prop_parent?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_prop_parent?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


145
146
147
148
149
150</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 145</span>

def invalid_prop_parent?(parent, child)
  unless is_any_of?(parent, VALID_PROP_PARENTS)
    &quot;Properties are only allowed within rules, directives, mixin includes, or other properties.&quot; +
      child.pseudo_class_selector_message
  end
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id="invalid_return_parent?-instance_method"> - (<tt>Boolean</tt>) <strong>invalid_return_parent?</strong>(parent, child) <span class=extras>(protected)</span> </h3><div class=docstring> <div class=discussion> </div> </div> <div class=tags> <p class=tag_title>Returns:</p> <ul class=return> <li> <span class=type>(<tt>Boolean</tt>)</span> </li> </ul> </div><table class=source_code> <tr> <td> <pre class=lines>


152
153
154</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 152</span>

def invalid_return_parent?(parent, child)
  &quot;@return may only be used within a function.&quot; unless parent.is_a?(Sass::Tree::FunctionNode)
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id=visit-instance_method> - <strong>visit</strong>(node) <span class=extras>(protected)</span> </h3><table class=source_code> <tr> <td> <pre class=lines>


9
10
11
12
13
14
15
16
17
18
19</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 9</span>

def visit(node)
  if (error = @parent &amp;&amp; (
      try_send(@parent.class.invalid_child_method_name, @parent, node) ||
      try_send(node.class.invalid_parent_method_name, @parent, node)))
    raise Sass::SyntaxError.new(error)
  end
  super
rescue Sass::SyntaxError =&gt; e
  e.modify_backtrace(:filename =&gt; node.filename, :line =&gt; node.line)
  raise e
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id=visit_children-instance_method> - <strong>visit_children</strong>(parent) <span class=extras>(protected)</span> </h3><table class=source_code> <tr> <td> <pre class=lines>


24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 24</span>

def visit_children(parent)
  old_parent = @parent

  # When checking a static tree, resolve at-roots to be sure they won&#39;t send
  # nodes where they don&#39;t belong.
  if parent.is_a?(Sass::Tree::AtRootNode) &amp;&amp; parent.resolved_value
    old_parents = @parents
    @parents = @parents.reject {|p| parent.exclude_node?(p)}
    @parent = Sass::Util.enum_with_index(@parents.reverse).
      find {|p, i| !transparent_parent?(p, @parents[-i - 2])}.first

    begin
      return super
    ensure
      @parents = old_parents
      @parent = old_parent
    end
  end

  unless transparent_parent?(parent, old_parent)
    @parent = parent
  end

  @parents.push parent
  begin
    super
  ensure
    @parent = old_parent
    @parents.pop
  end
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id=visit_import-instance_method> - <strong>visit_import</strong>(node) <span class=extras>(protected)</span> </h3><table class=source_code> <tr> <td> <pre class=lines>


63
64
65
66
67
68
69</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 63</span>

def visit_import(node)
  yield
rescue Sass::SyntaxError =&gt; e
  e.modify_backtrace(:filename =&gt; node.children.first.filename)
  e.add_backtrace(:filename =&gt; node.filename, :line =&gt; node.line)
  raise e
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id=visit_mixindef-instance_method> - <strong>visit_mixindef</strong>(node) <span class=extras>(protected)</span> </h3><table class=source_code> <tr> <td> <pre class=lines>


71
72
73
74
75
76</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 71</span>

def visit_mixindef(node)
  @current_mixin_def, old_mixin_def = node, @current_mixin_def
  yield
ensure
  @current_mixin_def = old_mixin_def
end</pre> </td> </tr> </table> </div> <div class="method_details "> <h3 class="signature " id=visit_root-instance_method> - <strong>visit_root</strong>(node) <span class=extras>(protected)</span> </h3><table class=source_code> <tr> <td> <pre class=lines>


56
57
58
59
60
61</pre> </td> <td> <pre class=code><span class="info file"># File '/home/nweiz/code/sass-site/.sass/lib/sass/tree/visitors/check_nesting.rb', line 56</span>

def visit_root(node)
  yield
rescue Sass::SyntaxError =&gt; e
  e.sass_template ||= node.template
  raise e
end</pre> </td> </tr> </table> </div> </div> </div> <div id=footer> Generated on Thu Feb 26 18:31:46 2015 by <a href="//yardoc.org" title="Yay! A Ruby Documentation Tool" target=_parent>yard</a> 0.8.7.4 (ruby-2.0.0). </div> </body> </html>